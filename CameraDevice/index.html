<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="Tizen basic template generated by Tizen Web IDE"/>

    <title>Tizen Web IDE - Tizen - Samsung Tizen TV basic Application</title>

    <script src="main.js"></script>
    <style>

.container {
  position: relative;
  text-align: center;
  color: white;
  width: 100%; 
  height: 100%; 
  position: absolute; 
  top: 0; 
  left: 0; 
}

/* Centered text */
.centered {
  font-size: 200px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

    </style>
</head>

<body>
<div class="container">
<table id="canvas" BGCOLOR="#000000" BORDER=0 CELLSPACING=0 CELLPADDING=0>
</table>
  <div class="centered" id="notice"></div>
</div>
</table>
</body>
<script type="text/javascript" src="jsmpeg.min.js"></script>
<script type="text/javascript">
    var currentChannel;
    var channelCount;
    getInfo(function (resp) {
        var mode = resp.mode;
        var pending = true;
        var scalefactor = Math.sqrt(mode);
        currentChannel = resp.currentChannel;
        channelCount = resp.channelCount;
        var notice = document.getElementById("notice");
        notice.innerHTML = currentChannel + " of " + channelCount;

        var table = document.getElementById("canvas");
        var trs = [];
        var tds = [];
        for (var i = 1; i < mode + 1; i++) {
            if (i !== 1 && (i - 1) % scalefactor === 0) {
                trs.push('<tr>' + tds.join('\n') + '</tr>');
                tds = [];
            }
            tds.push('<td> <canvas id="canvas' + i + '"/> </td>');
        }
        trs.push('<tr>' + tds.join('\n') + '</tr>');
        table.innerHTML = trs.join('\n');
        for (var _i = 0; _i < mode; _i++) {
            var url = 'ws://' + serverInfo.ip + ':' + (9999 + _i);
            var player = new JSMpeg.Player(url, {
                canvas: document.getElementById('canvas' + (_i + 1)),
                onVideoDecode: function ondecode( ) { if ( pending ) { notice.innerHTML = ""; pending = false; } },
            });
        }
    })
</script>
</html>
